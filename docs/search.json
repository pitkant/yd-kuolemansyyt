[
  {
    "objectID": "datan-visualisointi.html",
    "href": "datan-visualisointi.html",
    "title": "YP YD-visualisoinnit",
    "section": "",
    "text": "Tilastotietojen lataamisessa Tilastokeskuksen StatFin-tietokannasta käytetään pxweb-pakettia. Paketti mahdollistaa hakujen tekemisen tekstipohjaisesta käyttöliittymästä, jolloin haut ovat tallennettavissa, helposti toistettavissa ja muokattavissa suoraan R:stä. pxweb-paketti toimii monien eri pxweb-tietokantojen kanssa eri maissa. pxweb-paketti on kehitetty osana rOpenGov -pakettiekosysteemiä.\nDatan käsittelyyn (data wrangling) käytetään tidyverseen kuuluvia ggplot2-, dplyr- ja tidyr-paketteja.\nDatasettien nimien siivoamiseen käytetään janitor-pakettia.\nKuvien yhdistämiseksi paneelikuviksi hyödynnetään patchwork-pakettia.\n\n\nCode\nlibrary(\"pxweb\")\nlibrary(\"ggplot2\")\nlibrary(\"dplyr\")\nlibrary(\"tidyr\")\nlibrary(\"janitor\")\nlibrary(\"patchwork\")\nlibrary(\"xlsx\")\nlibrary(\"gt\")\nlibrary(\"knitr\")\nlibrary(\"kableExtra\")\nlibrary(\"RColorBrewer\")\nlibrary(\"ggthemes\")\nlibrary(\"ggstats\")"
  },
  {
    "objectID": "datan-visualisointi.html#keskiväkiluku",
    "href": "datan-visualisointi.html#keskiväkiluku",
    "title": "YP YD-visualisoinnit",
    "section": "Keskiväkiluku",
    "text": "Keskiväkiluku\nTilastokeskuksen aineistosta “11s1 – Keskiväkiluku iän ja sukupuolen mukaan alueittain, 1981-2024” (statfin_vaerak_pxt_11s1) saadaan tietoja vain vuoteen 1981 asti. Tästä johtuen myöhemmin tässä työkirjassa käytetään itse laskettua keskiväkilukua, mutta valmisaineisto ladataan tässä esimerkinomaisesti muistutuksena siitä, että tällainenkin on olemassa.\n\n\nCode\n# PXWEB query \npxweb_query_list &lt;- \n  list(\"Alue\"=\"SSS\",\n       \"Vuosi\"=as.character(1981:2024),\n       \"Sukupuoli\"=c(\"SSS\",\"1\",\"2\"),\n       \"Ikä\"=paste0(\"0\", 15:29),\n       \"Tiedot\"=c(\"keskiv\"))\n\n# Download data \npx_data &lt;- pxweb_get(url = \"https://statfin.stat.fi/PXWeb/api/v1/fi/StatFin/vaerak/statfin_vaerak_pxt_11s1.px\",\n            query = pxweb_query_list)\n\n# Convert to data.frame \nstatfin_vaerak_pxt_11s1 &lt;- as.data.frame(px_data,\n                                         column.name.type = \"text\",\n                                         variable.value.type = \"text\")\n\nstatfin_vaerak_pxt_11s1 &lt;- statfin_vaerak_pxt_11s1 %&gt;% \n  janitor::clean_names()\n\nif (tallenna_datasetit) {\n  saveRDS(object = statfin_vaerak_pxt_11s1, file = \"prepared_data/statfin_vaerak_pxt_11s1.rds\")\n}\n\n\n\nKeskiväkiluvun laskeminen itse\nTilastokeskuksen määritelmän mukaan:\n\nTietyn vuoden keskiväkiluku on kahden peräkkäisen vuoden väkilukujen keskiarvo. Kun tilastovuodelle lasketaan jotakin ilmiöta kuvaava suhdeluku, yleensä ko. ilmiön tapahtumien määrä suhteutetaan juuri tapahtumalle alttiina olevan väestön tai väestön osan keskiväkilukuun. Nämä väestöllisiä ilmiöitä kuvaavat luvut ilmoitetaan yleensä promilleina eli em. jakolaskun tulos kerrotaan tuhannella.\n\nEli vuoden 2024 keskiväkiluku saadaan laskemalla yhteen vuoden 2024 väkiluku ja vuoden 2023 väkiluku ja jakamalla tämä kahdella. Käytetään Tilastokeskuksen aineistoa “11rc – Väestö iän (5-v.) ja sukupuolen mukaan, 1865-2024” (statfin_vaerak_pxt_11rc).\n\n\nCode\n# PXWEB query \npxweb_query_list &lt;- \n  list(\"Vuosi\"=as.character(1865:2024),\n       \"Sukupuoli\"=c(\"SSS\"),\n       \"Ikä\"=c(\"15-19\", \"20-24\", \"25-29\"),\n       \"Tiedot\"=c(\"vaesto\"))\n\n# Download data \npx_data &lt;- \n  pxweb_get(url = \"https://statfin.stat.fi/PXWeb/api/v1/fi/StatFin/vaerak/statfin_vaerak_pxt_11rc.px\",\n            query = pxweb_query_list)\n\n# Convert to data.frame \nstatfin_vaerak_pxt_11rc &lt;- as.data.frame(px_data,\n                                         column.name.type = \"text\",\n                                         variable.value.type = \"text\")\n\nstatfin_vaerak_pxt_11rc &lt;- statfin_vaerak_pxt_11rc %&gt;% \n  janitor::clean_names()\n\nif (tallenna_datasetit) {\n  saveRDS(object = statfin_vaerak_pxt_11rc, file = \"prepared_data/statfin_vaerak_pxt_11rc.rds\")\n}\n\n\nMuodostetaan 15-29 -vuotiaiden ryhmä. Hyödynnetään dplyr-paketista löytyviä window function -funktioita eli lag-funktiota, saadaan valittua jokaiselle vuodelle sitä seuraavan vuoden luku (taulukko on järjestetty nousevaan järjestykseen eli ensimmäisenä on vanhin vuosi ja viimeisenä uusin vuosi, 2024).\n\n\nCode\nstatfin_vaerak_pxt_11rc &lt;- readRDS(\"prepared_data/statfin_vaerak_pxt_11rc.rds\")\n\nitse_laskettu_keskivakiluku &lt;- statfin_vaerak_pxt_11rc %&gt;% \n  group_by(vuosi) %&gt;% \n  summarize(vakiluku_15_29 = sum(vaesto_31_12)) %&gt;% \n  mutate(keskivakiluku = (vakiluku_15_29 + lag(vakiluku_15_29)) / 2) %&gt;% \n  ungroup()\n\n\n\n\nElinajanodote ikävuosittain\nTässä haetaan Tilastokeskuksen tietokannasta elinajanodote vuosina 1-v -tarkkuudella, lasketaan keskimääräinen elinajanodote ikäryhmittäin ilman painokerrointa. Esim. vuonna 1986 15-19 -vuotiaiden miesten keskimääräinen elinajanodote olisi\n\n\\[\n\\frac{56.2 + 55.23 + 54.26 + 53.31 + 52.38}{5} = 54.3\n\\]\n\nElinajanodotteet vuosina ovat järjestyksessä pienimmästä iästä suurimpaan, eli vuonna 1986 15-vuotiaiden elinajanodote oli 56.2 vuotta, 16-vuotiaiden 55.23 vuotta jne. Käytetään Tilastokeskuksen aineistoa “12ap – Kuolleisuus- ja eloonjäämislukuja iän ja sukupuolen mukaan, 1986-2024” (statfin_kuol_pxt_12ap).\n\n\nCode\n# PXWEB query \npxweb_query_list &lt;- \n  list(\"Vuosi\"=c(\"1986\",\"1987\",\"1988\",\"1989\",\"1990\",\"1991\",\"1992\",\"1993\",\"1994\",\"1995\",\"1996\",\"1997\",\"1998\",\"1999\",\"2000\",\"2001\",\"2002\",\"2003\",\"2004\",\"2005\",\"2006\",\"2007\",\"2008\",\"2009\",\"2010\",\"2011\",\"2012\",\"2013\",\"2014\",\"2015\",\"2016\",\"2017\",\"2018\",\"2019\",\"2020\",\"2021\",\"2022\",\"2023\",\"2024\"),\n       \"Sukupuoli\"=c(\"SSS\",\"1\",\"2\"),\n       \"Ikä\"=c(\"015\",\"016\",\"017\",\"018\",\"019\",\"020\",\"021\",\"022\",\"023\",\"024\",\"025\",\"026\",\"027\",\"028\",\"029\"),\n       \"Tiedot\"=c(\"eodote\"))\n\n# Download data \npx_data &lt;- \n  pxweb_get(url = \"https://statfin.stat.fi/PXWeb/api/v1/fi/StatFin/kuol/statfin_kuol_pxt_12ap.px\",\n            query = pxweb_query_list)\n\n# Convert to data.frame \npx_data_frame &lt;- as.data.frame(px_data, column.name.type = \"text\", variable.value.type = \"text\")\n\nkuolleet_12ap &lt;- px_data_frame %&gt;% \n  janitor::clean_names() %&gt;% \n  mutate(ikaluokka = case_when(\n    ika %in% c(as.character(15:19)) ~ \"15 - 19\",\n    ika %in% c(as.character(20:24)) ~ \"20 - 24\",\n    ika %in% c(as.character(25:29)) ~ \"25 - 29\",\n    .default = as.character(ika)\n  )) %&gt;% \n  group_by(ikaluokka, sukupuoli, vuosi) %&gt;% \n  summarize(elinajanodote_vuosia_mean = mean(elinajanodote_vuosia)) %&gt;% \n  ungroup()\n\nif (tallenna_datasetit) {\n  saveRDS(object = kuolleet_12ap, file = \"prepared_data/statfin_kuol_pxt_12ap_summarized.rds\")\n}"
  },
  {
    "objectID": "datan-visualisointi.html#filtteröinti",
    "href": "datan-visualisointi.html#filtteröinti",
    "title": "YP YD-visualisoinnit",
    "section": "Filtteröinti",
    "text": "Filtteröinti\njanitor-paketin clean_names()-funktiolla muutetaan suomenkieliset muuttujanimet helpommin käsiteltäviksi ASCII-nimiksi, joissa poistetaan isot kirjaimet, välilyönnit korvataan _-merkillä, ääkköset poistetaan ym.\nMuodostetaan uusi muuttuja “kuolemansyy” jota voidaan käyttää eri kuolemansyiden lukujen ryhmittelyyn visualisoinneissa.\n\n\nCode\nstatfin_ksyyt_pxt_11az &lt;- readRDS(\"prepared_data/statfin_ksyyt_pxt_11az.rds\")\nstatfin_ksyyt_pxt_12d9 &lt;- readRDS(\"prepared_data/statfin_ksyyt_pxt_12d9.rds\")\n\nitsemurhat_vakivalta &lt;- statfin_ksyyt_pxt_11az %&gt;% \n  # filter(sukupuoli %in% c(\"Miehet\", \"Naiset\"), as.numeric(vuosi) &gt;= 2006) %&gt;% \n  # filter(!(tilaston_peruskuolemansyy_aikasarjaluokitus %in% \"00-54 Yhteensä\")) %&gt;% \n  group_by(tilaston_peruskuolemansyy_aikasarjaluokitus, vuosi, ika, sukupuoli) %&gt;% \n  summarize(kuolleet_06_24 = sum(kuolleet)) %&gt;% \n  mutate(kuolemansyy = case_when(\n    tilaston_peruskuolemansyy_aikasarjaluokitus == \"50 Itsemurhat (X60-X84, Y870)\" ~ \"itsemurha\",\n    tilaston_peruskuolemansyy_aikasarjaluokitus == \"51 Murha, tappo tai muu tahallinen pahoinpitely (X85-Y09, Y871)\" ~ \"vakivalta\",\n    .default = \"muut\"\n  )) %&gt;% \n  ungroup() %&gt;% \n  select(vuosi, ika, sukupuoli, kuolleet_06_24, kuolemansyy)\n\nstatfin_ksyyt_pxt_12d9 &lt;- statfin_ksyyt_pxt_12d9 %&gt;% \n  janitor::clean_names()\n\nhuumekuolemat &lt;- statfin_ksyyt_pxt_12d9 %&gt;% \n  # filter(sukupuoli %in% c(\"Miehet\", \"Naiset\"), as.numeric(vuosi) &gt;= 2006) %&gt;% \n  group_by(vuosi, ika, sukupuoli) %&gt;% \n  summarize(kuolleet_06_24 = sum(huumeisiin_kuolleet_b_luokitus, na.rm = TRUE)) %&gt;% \n  ungroup() %&gt;% \n  mutate(kuolemansyy = \"huumekuolema\")"
  },
  {
    "objectID": "datan-visualisointi.html#filtteröinti-1",
    "href": "datan-visualisointi.html#filtteröinti-1",
    "title": "YP YD-visualisoinnit",
    "section": "Filtteröinti",
    "text": "Filtteröinti\n\n\nCode\nitsemurhat_ikaryhmat &lt;- itsemurhat_vakivalta %&gt;% \n  filter(as.numeric(vuosi) &gt;= 2006) %&gt;%\n  filter(kuolemansyy == \"itsemurha\") %&gt;% \n  filter(sukupuoli == \"Yhteensä\")\n\nvakivalta_ikaryhmat &lt;- itsemurhat_vakivalta %&gt;% \n  filter(as.numeric(vuosi) &gt;= 2006) %&gt;%\n  filter(kuolemansyy == \"vakivalta\") %&gt;% \n  filter(sukupuoli == \"Yhteensä\")\n\nhuumekuolemat_ikaryhmat &lt;- huumekuolemat %&gt;% \n  filter(as.numeric(vuosi) &gt;= 2006) %&gt;%\n  filter(sukupuoli == \"Yhteensä\")\n\nitsemurhat_ikaryhmat_total &lt;- itsemurhat_ikaryhmat %&gt;% \n  group_by(vuosi, sukupuoli, kuolemansyy) %&gt;% \n  summarize(kuolleet_06_24 = sum(kuolleet_06_24)) %&gt;% \n  mutate(ika = \"15 - 29 (Yhteensä)\") %&gt;% \n  select(vuosi, ika, sukupuoli, kuolleet_06_24, kuolemansyy)\n\nvakivalta_ikaryhmat_total &lt;- vakivalta_ikaryhmat %&gt;% \n  group_by(vuosi, sukupuoli, kuolemansyy) %&gt;% \n  summarize(kuolleet_06_24 = sum(kuolleet_06_24)) %&gt;% \n  mutate(ika = \"15 - 29 (Yhteensä)\") %&gt;% \n  select(vuosi, ika, sukupuoli, kuolleet_06_24, kuolemansyy)\n\nhuumekuolemat_ikaryhmat_total &lt;- huumekuolemat_ikaryhmat %&gt;% \n  group_by(vuosi, sukupuoli, kuolemansyy) %&gt;% \n  summarize(kuolleet_06_24 = sum(kuolleet_06_24)) %&gt;% \n  mutate(ika = \"15 - 29 (Yhteensä)\") %&gt;% \n  select(vuosi, ika, sukupuoli, kuolleet_06_24, kuolemansyy)\n\n\nMuutetaan ika-muuttujan character-arvot faktoreiksi, jolloin voidaan määritellä manuaalisesti niiden järjestys. Normaalisti muuttujat visualisoitaisiin aakkosjärjestyksessä (alfanumeerisessa järjestyksessä), jolloin numerot tulisivat ennen tekstimuuttujia. Haluamme kuitenkin tässä (?), että “Yhteensä” on ennen numeroita.\n\n\nCode\nitsemurhat_ikaryhmat_2 &lt;- rbind(itsemurhat_ikaryhmat, itsemurhat_ikaryhmat_total) %&gt;% \n  mutate(ika = factor(ika, levels=c(\"15 - 29 (Yhteensä)\", \"15 - 19\", \"20 - 24\", \"25 - 29\")))\n\nvakivalta_ikaryhmat_2 &lt;- rbind(vakivalta_ikaryhmat, vakivalta_ikaryhmat_total) %&gt;% \n  mutate(ika = factor(ika, levels=c(\"15 - 29 (Yhteensä)\", \"15 - 19\", \"20 - 24\", \"25 - 29\")))\n\nhuumekuolemat_ikaryhmat_2 &lt;- rbind(huumekuolemat_ikaryhmat, huumekuolemat_ikaryhmat_total) %&gt;% \n  mutate(ika = factor(ika, levels=c(\"15 - 29 (Yhteensä)\", \"15 - 19\", \"20 - 24\", \"25 - 29\")))"
  },
  {
    "objectID": "datan-visualisointi.html#visualisointi-geom_bar-dodge",
    "href": "datan-visualisointi.html#visualisointi-geom_bar-dodge",
    "title": "YP YD-visualisoinnit",
    "section": "Visualisointi (geom_bar dodge)",
    "text": "Visualisointi (geom_bar dodge)\n\nMustavalkoinen\nTässä visualisoinnissa esitetään erikseen eri kuolinsyiden Yhteensä-määrä ja erilliset kuolinsyyt omina palkkeinaan.\nHyödyntämällä patchwork-kirjastoa saamme yhdistettyä useita kuvioita yhteen.\n\n\nCode\nkuvio1 &lt;- ggplot(data = itsemurhat_ikaryhmat_2, aes(fill = ika, y=kuolleet_06_24, x=as.numeric(vuosi))) +\n  geom_bar(position=\"dodge\", stat=\"identity\", color = \"black\") + \n  labs(title = \"Itsemurhiin kuolleet 15-29 -vuotiaat 2006-2024\",\n       caption = \"Lähde: Tilastokeskus / StatFin (statfin_ksyyt_pxt_11az)\",\n       x = \"Vuosi\",\n       y = \"Kuolleita (n)\",\n       fill = \"Ikäryhmä\") +\n  scale_fill_grey(start = 0.15, end = 0.7) +\n  theme(legend.position = \"bottom\") +\n  scale_colour_grey() +\n  theme_tufte(base_size = 8, base_family = \"sans\")\n\nkuvio1\n\n\n\n\n\nCode\nkuvio2 &lt;- ggplot(vakivalta_ikaryhmat_2, aes(fill = ika, y=kuolleet_06_24, x=as.numeric(vuosi))) +\n  geom_bar(position=\"dodge\", stat=\"identity\", color = \"black\") + \n  labs(title = \"Väkivaltaan kuolleet 15-29 -vuotiaat 2006-2024\",\n       caption = \"Lähde: Tilastokeskus / StatFin (statfin_ksyyt_pxt_11az)\",\n       x = \"Vuosi\",\n       y = \"Kuolleita (n)\",\n       fill = \"Ikäryhmä\") +\n  scale_fill_grey(start = 0.15, end = 0.7) +\n  theme(legend.position = \"bottom\") +\n  scale_colour_grey() +\n  theme_tufte(base_size = 8, base_family = \"sans\")\n\nkuvio2\n\n\n\n\n\nCode\nkuvio3 &lt;- ggplot(huumekuolemat_ikaryhmat_2, aes(fill = ika, y=kuolleet_06_24, x=as.numeric(vuosi))) +\n  geom_bar(position=\"dodge\", stat=\"identity\", color = \"black\") + \n  labs(title = \"Huumeisiin kuolleet 15-29 -vuotiaat 2006-2024\",\n       caption = \"Lähde: Tilastokeskus / StatFin (statfin_ksyyt_pxt_12d9)\",\n       x = \"Vuosi\",\n       y = \"Kuolleita (n)\",\n       fill = \"Ikäryhmä\") +\n  scale_fill_grey(start = 0.15, end = 0.7) +\n  theme(legend.position = \"bottom\") +\n  scale_colour_grey() +\n  theme_tufte(base_size = 8, base_family = \"sans\")\n\nkuvio3\n\n\n\n\n\n\n\nKuviot 1-3: Datan tallennus exceliin\nData kannattaa tallentaa ensin vähän leveämpään muotoon\n\n\nCode\nitsemurhat_ikaryhmat_2_wide &lt;- itsemurhat_ikaryhmat_2 %&gt;% \n  dplyr::select(vuosi, ika, kuolleet_06_24) %&gt;% \n  mutate(ika = case_when(\n    ika == \"15 - 19\" ~ \"15_19\",\n    ika == \"20 - 24\" ~ \"20_24\",\n    ika == \"25 - 29\" ~ \"25_29\",\n    ika == \"15 - 29 (Yhteensä)\" ~ \"yhteensa\",\n    .default = as.character(ika)\n  )) %&gt;% \n  tidyr::pivot_wider(names_from = ika, names_prefix = \"ika_\", values_from = kuolleet_06_24)\n\nvakivalta_ikaryhmat_2_wide &lt;- vakivalta_ikaryhmat_2 %&gt;% \n  dplyr::select(vuosi, ika, kuolleet_06_24) %&gt;% \n  mutate(ika = case_when(\n    ika == \"15 - 19\" ~ \"15_19\",\n    ika == \"20 - 24\" ~ \"20_24\",\n    ika == \"25 - 29\" ~ \"25_29\",\n    ika == \"15 - 29 (Yhteensä)\" ~ \"yhteensa\",\n    .default = as.character(ika)\n  )) %&gt;% \n  tidyr::pivot_wider(names_from = ika, names_prefix = \"ika_\", values_from = kuolleet_06_24)\n\nhuumekuolemat_ikaryhmat_2_wide &lt;- huumekuolemat_ikaryhmat_2 %&gt;% \n  dplyr::select(vuosi, ika, kuolleet_06_24) %&gt;% \n  mutate(ika = case_when(\n    ika == \"15 - 19\" ~ \"15_19\",\n    ika == \"20 - 24\" ~ \"20_24\",\n    ika == \"25 - 29\" ~ \"25_29\",\n    ika == \"15 - 29 (Yhteensä)\" ~ \"yhteensa\",\n    .default = as.character(ika)\n  )) %&gt;% \n  tidyr::pivot_wider(names_from = ika, names_prefix = \"ika_\", values_from = kuolleet_06_24)\n\n\nif (kirjoita_data_excel_tiedostoihin) {\n  write.xlsx(itsemurhat_ikaryhmat_2_wide,\n           file = \"/Users/pyrykantanen/Github/yd-kuolemansyyt/prepared_data/yd_artikkeli_kuviot.xlsx\",\n           sheetName = \"Kuvio_1_itsemurha\",\n           append = FALSE)\n  \n  write.xlsx(huumekuolemat_ikaryhmat_2_wide,\n           file = \"/Users/pyrykantanen/Github/yd-kuolemansyyt/prepared_data/yd_artikkeli_kuviot.xlsx\",\n           sheetName = \"Kuvio_2_huumekuolemat\", \n           append = TRUE)\n\n  write.xlsx(vakivalta_ikaryhmat_2_wide,\n             file = \"/Users/pyrykantanen/Github/yd-kuolemansyyt/prepared_data/yd_artikkeli_kuviot.xlsx\",\n             sheetName = \"Kuvio_3_vakivalta\", \n             append = TRUE)\n}"
  },
  {
    "objectID": "datan-visualisointi.html#grouped-bar--kuvaajat",
    "href": "datan-visualisointi.html#grouped-bar--kuvaajat",
    "title": "YP YD-visualisoinnit",
    "section": "Grouped bar -kuvaajat",
    "text": "Grouped bar -kuvaajat\n\n\nCode\nkuvio1 &lt;- ggplot(data = itsemurhat_ikaryhmat_2, aes(fill = ika, y=kuolleet_06_24, x=as.numeric(vuosi))) +\n  geom_bar(position=\"dodge\", stat=\"identity\", color = \"black\", size = 0.25) + \n  labs(x = \"Vuosi\",\n       y = \"\",\n       fill = \"Ikäryhmä\") +\n  scale_fill_grey(start = 0.15, end = 0.7) +\n  theme(legend.position = \"bottom\") +\n  scale_colour_grey() +\n  theme_tufte(base_size = 8, base_family = \"sans\")\n\nkuvio1\n\n\n\n\n\nCode\nkuvio2 &lt;- ggplot(vakivalta_ikaryhmat_2, aes(fill = ika, y=kuolleet_06_24, x=as.numeric(vuosi))) +\n  geom_bar(position=\"dodge\", stat=\"identity\", color = \"black\", size = 0.25) + \n  labs(x = \"Vuosi\",\n       y = \"\",\n       fill = \"Ikäryhmä\") +\n  scale_fill_grey(start = 0.15, end = 0.7) +\n  theme(legend.position = \"bottom\") +\n  scale_colour_grey() +\n  theme_tufte(base_size = 8, base_family = \"sans\")\n\nkuvio2\n\n\n\n\n\nCode\nkuvio3 &lt;- ggplot(huumekuolemat_ikaryhmat_2, aes(fill = ika, y=kuolleet_06_24, x=as.numeric(vuosi))) +\n  geom_bar(position=\"dodge\", stat=\"identity\", color = \"black\", size = 0.25) + \n  labs(x = \"Vuosi\",\n       y = \"\",\n       fill = \"Ikäryhmä\") +\n  scale_fill_grey(start = 0.15, end = 0.7) +\n  theme(legend.position = \"bottom\") +\n  scale_colour_grey() +\n  theme_tufte(base_size = 8, base_family = \"sans\")\n\nkuvio3\n\n\n\n\n\nCode\nif (tuota_vektorikuviot) {\n  ggsave(\"prepared_plots/kuvio1_13x8.pdf\", plot = kuvio1, width = 130, height = 80, units = \"mm\", dpi = 300, scale = 1)\n  ggsave(\"prepared_plots/kuvio2_13x8.pdf\", plot = kuvio2, width = 130, height = 80, units = \"mm\", dpi = 300, scale = 1)\n  ggsave(\"prepared_plots/kuvio3_13x8.pdf\", plot = kuvio3, width = 130, height = 80, units = \"mm\", dpi = 300, scale = 1)\n}"
  },
  {
    "objectID": "datan-visualisointi.html#vaihtoehto-viivakuvaajat",
    "href": "datan-visualisointi.html#vaihtoehto-viivakuvaajat",
    "title": "YP YD-visualisoinnit",
    "section": "Vaihtoehto: Viivakuvaajat",
    "text": "Vaihtoehto: Viivakuvaajat\n\n\nCode\nkuvio1 &lt;- ggplot(itsemurhat_ikaryhmat_2, aes(group = ika, y=kuolleet_06_24, x=as.numeric(vuosi))) +\n  geom_line(aes(color=ika, linetype=ika), linewidth = 1/.pt) + \n  labs(x = \"Vuosi\",\n       y = \"\",\n       color = \"Ikäryhmä\", linetype = \"Ikäryhmä\") +\n  scale_color_grey(start = 0.7, end = 0.15) +\n  theme(legend.position = \"bottom\") +\n  theme_tufte(base_size = 8, base_family = \"sans\")\n\nkuvio1\n\n\n\n\n\nCode\nkuvio2 &lt;- ggplot(huumekuolemat_ikaryhmat_2, aes(group = ika, y=kuolleet_06_24, x=as.numeric(vuosi))) +\n  geom_line(aes(color=ika, linetype=ika), linewidth = 1/.pt) + \n  labs(x = \"Vuosi\",\n       y = \"\",\n       color = \"Ikäryhmä\", linetype = \"Ikäryhmä\") +\n  scale_color_grey(start = 0.7, end = 0.15) +\n  theme(legend.position = \"bottom\") +\n  theme_tufte(base_size = 8, base_family = \"sans\")\n\nkuvio2\n\n\n\n\n\nCode\nkuvio3 &lt;- ggplot(vakivalta_ikaryhmat_2, aes(group = ika, y=kuolleet_06_24, x=as.numeric(vuosi))) +\n  geom_line(aes(color=ika, linetype=ika), linewidth = 1/.pt) + \n  labs(x = \"Vuosi\",\n       y = \"\",\n       color = \"Ikäryhmä\", linetype = \"Ikäryhmä\") +\n  scale_color_grey(start = 0.7, end = 0.15) +\n  theme(legend.position = \"bottom\") +\n  theme_tufte(base_size = 8, base_family = \"sans\")\n\nkuvio3\n\n\n\n\n\nCode\nif (tuota_vektorikuviot & tuota_viivakuviot) {\n  ggsave(\"prepared_plots/kuvio1_13x8.pdf\", plot = kuvio1, width = 130, height = 80, units = \"mm\", dpi = 300, scale = 1)\n  ggsave(\"prepared_plots/kuvio2_13x8.pdf\", plot = kuvio2, width = 130, height = 80, units = \"mm\", dpi = 300, scale = 1)\n  ggsave(\"prepared_plots/kuvio3_13x8.pdf\", plot = kuvio3, width = 130, height = 80, units = \"mm\", dpi = 300, scale = 1)\n}"
  },
  {
    "objectID": "datan-visualisointi.html#visualisointi-geom_bar-dodge-patchwork",
    "href": "datan-visualisointi.html#visualisointi-geom_bar-dodge-patchwork",
    "title": "YP YD-visualisoinnit",
    "section": "Visualisointi (geom_bar dodge + patchwork)",
    "text": "Visualisointi (geom_bar dodge + patchwork)\n\nMustavalkoinen\nHyödyntämällä patchwork-kirjastoa saamme yhdistettyä useita kuvioita yhteen.\n\n\nCode\np1 &lt;- ggplot() +\n  geom_bar(data = itsemurhat_ikaryhmat_2, aes(fill = ika, y=kuolleet_06_24, x=as.numeric(vuosi)), position=\"dodge\", stat=\"identity\", color = \"black\") + \n  ylim(0, 200) +\n  scale_fill_grey(start = 0.7, end = 0.15) +\n  labs(title = \"Itsemurhat\", x = \"Vuosi\", y = \"Kuolleet (n)\", fill = \"Ikäryhmä\")\n\np2 &lt;- ggplot(vakivalta_ikaryhmat_2, aes(fill = ika, y=kuolleet_06_24, x=as.numeric(vuosi))) +\n  geom_bar(position=\"dodge\", stat=\"identity\", color = \"black\") + \n  ylim(0, 200) +\n  scale_fill_grey(start = 0.7, end = 0.15) +\n  labs(title = \"Väkivalta\", x = \"Vuosi\", y = \"Kuolleet (n)\", fill = \"Ikäryhmä\")\n\np3 &lt;- ggplot(huumekuolemat_ikaryhmat_2, aes(fill = ika, y=kuolleet_06_24, x=as.numeric(vuosi))) +\n  geom_bar(position=\"dodge\", stat=\"identity\", color = \"black\") + \n  ylim(0, 200) +\n  scale_fill_grey(start = 0.7, end = 0.15) +\n  labs(title = \"Huumeet\", x = \"Vuosi\", y = \"Kuolleet (n)\", fill = \"Ikäryhmä\")\n\np1 + p2 + p3 + plot_layout(ncol = 1, guides = \"collect\", axis_titles = \"collect\") & theme(legend.position = \"right\")"
  },
  {
    "objectID": "datan-visualisointi.html#visualisointi-geom_bar-stacked",
    "href": "datan-visualisointi.html#visualisointi-geom_bar-stacked",
    "title": "YP YD-visualisoinnit",
    "section": "Visualisointi (geom_bar stacked)",
    "text": "Visualisointi (geom_bar stacked)\n\nMustavalkoinen\n\nKuvio 1a 1-3: YD-kuolemat ikäryhmittäin\nTässä visualisoinnissa YD-kuolemien kokonaismäärä näkyy pinoamalla erilliset kuolinsyyt yhdeksi palkiksi.\n“Kuviot julkaistaan printtilehdessä mustavalkoisena, mikä tulee ottaa huomioon kuvioita suunniteltaessa.”\n\n\nCode\nggplot() +\n  # geom_bar(data = itsemurhat_ikaryhmat_total, aes(y = total, x=as.numeric(vuosi)), stat=\"identity\", position=\"dodge\") +\n  geom_bar(data = itsemurhat_ikaryhmat, aes(fill = ika, y=kuolleet_06_24, x=as.numeric(vuosi)), position=\"stack\", stat=\"identity\", color = \"black\") + \n  labs(title = \"Itsemurhiin kuolleet 15-29 -vuotiaat 2006-2024\",\n       caption = \"Lähde: Tilastokeskus / StatFin (statfin_ksyyt_pxt_11az)\",\n       x = \"Vuosi\",\n       y = \"Kuolleita (n)\",\n       fill = \"Ikäryhmä\") + \n  scale_fill_grey(start = 0.75, end = 0.25) +\n  theme(legend.position = \"bottom\")\n\n\n\n\n\nCode\nggplot(vakivalta_ikaryhmat, aes(fill = ika, y=kuolleet_06_24, x=as.numeric(vuosi))) +\n  geom_bar(position=\"stack\", stat=\"identity\", color = \"black\") + \n  labs(title = \"Väkivaltaan kuolleet 15-29 -vuotiaat 2006-2024\",\n       caption = \"Lähde: Tilastokeskus / StatFin (statfin_ksyyt_pxt_11az)\",\n       x = \"Vuosi\",\n       y = \"Kuolleita (n)\",\n       fill = \"Ikäryhmä\") +\n  scale_fill_grey(start = 0.75, end = 0.25) +\n  theme(legend.position = \"bottom\")\n\n\n\n\n\nCode\nggplot(huumekuolemat_ikaryhmat, aes(fill = ika, y=kuolleet_06_24, x=as.numeric(vuosi))) +\n  geom_bar(position=\"stack\", stat=\"identity\", color = \"black\") + \n  labs(title = \"Huumeisiin kuolleet 15-29 -vuotiaat 2006-2024\",\n       caption = \"Lähde: Tilastokeskus / StatFin (statfin_ksyyt_pxt_12d9)\",\n       x = \"Vuosi\",\n       y = \"Kuolleita (n)\",\n       fill = \"Ikäryhmä\") +\n  scale_fill_grey(start = 0.75, end = 0.25) +\n  theme(legend.position = \"bottom\")\n\n\n\n\n\n\n\n\nVärilliset kuviot\n“Kuviossa mahdollisesti käytetyt värit tulevat näkyviin artikkelin nettiversiossa.” Ikäryhmien visualisointiin käytetään tässä väripalettia BuPu, joka on colorblind safe, sequential (ks. lisätietoja ja lisää paletteja: colorbrewer2.org).\n\nKuvio 1b 1: Itsemurhat ikäryhmittäin, värillinen\n\n\nCode\nggplot() +\n  geom_bar(data = itsemurhat_ikaryhmat, aes(fill = ika, y=kuolleet_06_24, x=as.numeric(vuosi)), position=\"stack\", stat=\"identity\", color = \"black\") + \n  labs(x = \"Vuosi\",\n       y = \"\",\n       fill = \"Ikäryhmä\") +\n  scale_fill_brewer(palette = \"BuPu\") +\n  theme(legend.position = \"bottom\")\n\n\n\n\n\nKuvateksti: Itsemurhiin kuolleiden 15-29 -vuotiaiden määrä ikäryhmittäin vuosina 2006-2024. Lähde: Tilastokeskus, kuolemansyyt (Tietokantataulukot: 11az – Kuolleet tilaston peruskuolemansyyn (aikasarjaluokitus), iän ja sukupuolen mukaan, 1969-2024)\n\n\nKuvio 1b 2: Väkivaltakuolemat ikäryhmittäin, värillinen\n\n\nCode\nggplot(vakivalta_ikaryhmat, aes(fill = ika, y=kuolleet_06_24, x=as.numeric(vuosi))) +\n  geom_bar(position=\"stack\", stat=\"identity\", colour = \"black\") + \n  labs(x = \"Vuosi\",\n       y = \"\",\n       fill = \"Ikäryhmä\") +\n  scale_fill_brewer(palette = \"BuPu\") +\n  theme(legend.position = \"bottom\")\n\n\n\n\n\nKuvateksti: Väkivaltaan kuolleiden 15-29 -vuotiaiden määrä ikäryhmittäin vuosina 2006-2024. Lähde: Tilastokeskus, kuolemansyyt (Tietokantataulukot: 11az – Kuolleet tilaston peruskuolemansyyn (aikasarjaluokitus), iän ja sukupuolen mukaan, 1969-2024)\n\n\nKuvio 1b 3: Huumekuolemat ikäryhmittäin, värillinen\n\n\nCode\nggplot(huumekuolemat_ikaryhmat, aes(fill = ika, y=kuolleet_06_24, x=as.numeric(vuosi))) +\n  geom_bar(position=\"stack\", stat=\"identity\", colour = \"black\") + \n  labs(x = \"Vuosi\",\n       y = \"\",\n       fill = \"Ikäryhmä\") +\n  scale_fill_brewer(palette = \"BuPu\") +\n  theme(legend.position = \"bottom\")\n\n\n\n\n\nKuvateksti: Huumeisiin kuolleiden 15-29 -vuotiaiden määrä ikäryhmittäin vuosina 2006-2024. Lähde: Tilastokeskus, kuolemansyyt (Tietokantataulukot: 12d9 – Huumeisiin kuolleet (B-luokitus) tilaston peruskuolemansyyn, iän ja sukupuolen mukaan, 2006-2024)"
  },
  {
    "objectID": "datan-visualisointi.html#filtteröinti-2",
    "href": "datan-visualisointi.html#filtteröinti-2",
    "title": "YP YD-visualisoinnit",
    "section": "Filtteröinti",
    "text": "Filtteröinti\n\n\nCode\nitsemurhat_sp &lt;- itsemurhat_vakivalta %&gt;% \n  filter(kuolemansyy == \"itsemurha\") %&gt;% \n  filter(as.numeric(vuosi) &gt;= 2006) %&gt;%\n  filter(sukupuoli %in% c(\"Miehet\", \"Naiset\")) %&gt;% \n  group_by(vuosi, sukupuoli) %&gt;% \n  summarize(kuolleet_06_24_sp = sum(kuolleet_06_24, na.rm = TRUE)) %&gt;% \n  ungroup()\n\nvakivalta_sp &lt;- itsemurhat_vakivalta %&gt;% \n  filter(kuolemansyy == \"vakivalta\") %&gt;% \n  filter(as.numeric(vuosi) &gt;= 2006) %&gt;%\n  filter(sukupuoli %in% c(\"Miehet\", \"Naiset\")) %&gt;% \n  group_by(vuosi, sukupuoli) %&gt;% \n  summarize(kuolleet_06_24_sp = sum(kuolleet_06_24, na.rm = TRUE)) %&gt;% \n  ungroup()\n\nhuumekuolemat_sp &lt;- huumekuolemat %&gt;% \n  filter(as.numeric(vuosi) &gt;= 2006) %&gt;%\n  filter(sukupuoli %in% c(\"Miehet\", \"Naiset\")) %&gt;% \n  group_by(vuosi, sukupuoli) %&gt;% \n  summarize(kuolleet_06_24_sp = sum(kuolleet_06_24, na.rm = TRUE)) %&gt;% \n  ungroup()"
  },
  {
    "objectID": "datan-visualisointi.html#visualisointi-geom_bar-dodge-1",
    "href": "datan-visualisointi.html#visualisointi-geom_bar-dodge-1",
    "title": "YP YD-visualisoinnit",
    "section": "Visualisointi (geom_bar dodge)",
    "text": "Visualisointi (geom_bar dodge)\n\nMustavalkoiset kuviot\n\nKuviot 2a 1-3: YD-kuolemat sukupuolittain, mustavalkoinen\nMustavalkoiset kuviot, joissa on mukana title, caption ja y-akselin label:\n\n\nCode\nggplot(itsemurhat_sp, aes(fill = sukupuoli, y=kuolleet_06_24_sp, x=as.numeric(vuosi))) +\n  geom_bar(position=\"dodge\", stat=\"identity\", color = \"black\") + \n  labs(title = \"Itsemurhiin kuolleet 15-29 -vuotiaat 2006-2024\",\n       caption = \"Lähde: Tilastokeskus / StatFin (statfin_ksyyt_pxt_11az)\",\n       x = \"Vuosi\",\n       y = \"Kuolleita (n)\",\n       fill = \"Sukupuoli\") +\n  scale_fill_grey(start = 0, end = 0.5) +\n  theme(legend.position = \"bottom\")\n\n\n\n\n\nCode\nggplot(vakivalta_sp, aes(fill = sukupuoli, y=kuolleet_06_24_sp, x=as.numeric(vuosi))) +\n  geom_bar(position=\"dodge\", stat=\"identity\", color = \"black\") + \n  labs(title = \"Väkivaltaan kuolleet 15-29 -vuotiaat 2006-2024\",\n       caption = \"Lähde: Tilastokeskus / StatFin (statfin_ksyyt_pxt_11az)\",\n       x = \"Vuosi\",\n       y = \"Kuolleita (n)\",\n       fill = \"Sukupuoli\") +\n  scale_fill_grey(start = 0, end = 0.5) +\n  theme(legend.position = \"bottom\")\n\n\n\n\n\nCode\nggplot(huumekuolemat_sp, aes(fill = sukupuoli, y=kuolleet_06_24_sp, x=as.numeric(vuosi))) +\n  geom_bar(position=\"dodge\", stat=\"identity\", color = \"black\") + \n  labs(title = \"Huumeisiin kuolleet 15-29 -vuotiaat 2006-2024\",\n       caption = \"Lähde: Tilastokeskus / StatFin (statfin_ksyyt_pxt_12d9)\",\n       x = \"Vuosi\",\n       y = \"Kuolleita (n)\",\n       fill = \"Sukupuoli\") +\n  scale_fill_grey(start = 0, end = 0.5) +\n  theme(legend.position = \"bottom\")\n\n\n\n\n\n\n\n\nVärilliset kuviot\n\nKuvio 2b 1: Itsemurhat sukupuolittain, värillinen\nVärilliset kuvat. Sukupuolen visualisointiin käytetään tässä väripalettia Set2 joka on colorblind safe, qualitative (ks. lisätietoja ja lisää paletteja: colorbrewer2.org).\n\n\nCode\nggplot(itsemurhat_sp, aes(fill = sukupuoli, y=kuolleet_06_24_sp, x=as.numeric(vuosi))) +\n  geom_bar(position=\"dodge\", stat=\"identity\", color = \"black\") + \n  labs(x = \"Vuosi\",\n       y = \"\",\n       fill = \"Sukupuoli\") +\n  scale_fill_brewer(palette = \"Set2\") +\n  theme(legend.position = \"bottom\")\n\n\n\n\n\nKuvateksti: Itsemurhiin kuolleiden 15-29 -vuotiaiden miesten ja naisten määrä vuosina 2006-2024. Lähde: Tilastokeskus, kuolemansyyt (Tietokantataulukot: 11az – Kuolleet tilaston peruskuolemansyyn (aikasarjaluokitus), iän ja sukupuolen mukaan, 1969-2024)\n\n\nKuvio 2b 2: Väkivaltakuolemat sukupuolittain, värillinen\n\n\nCode\nggplot(vakivalta_sp, aes(fill = sukupuoli, y=kuolleet_06_24_sp, x=as.numeric(vuosi))) +\n  geom_bar(position=\"dodge\", stat=\"identity\", color = \"black\") + \n  labs(x = \"Vuosi\",\n       y = \"\",\n       fill = \"Sukupuoli\") +\n  scale_fill_brewer(palette = \"Set2\") +\n  theme(legend.position = \"bottom\")\n\n\n\n\n\nKuvateksti: Väkivaltaan kuolleiden 15-29 -vuotiaiden miesten ja naisten määrä vuosina 2006-2024. Lähde: Tilastokeskus, kuolemansyyt (Tietokantataulukot: 11az – Kuolleet tilaston peruskuolemansyyn (aikasarjaluokitus), iän ja sukupuolen mukaan, 1969-2024)\n\n\nKuvio 2b 3: Huumekuolemat sukupuolittain, värillinen\n\n\nCode\nggplot(huumekuolemat_sp, aes(fill = sukupuoli, y=kuolleet_06_24_sp, x=as.numeric(vuosi))) +\n  geom_bar(position=\"dodge\", stat=\"identity\", color = \"black\") + \n  labs(x = \"Vuosi\",\n       y = \"\",\n       fill = \"Sukupuoli\") +\n  scale_fill_brewer(palette = \"Set2\") +\n  theme(legend.position = \"bottom\")\n\n\n\n\n\nKuvateksti: Huumeisiin kuolleiden 15-29 -vuotiaiden miesten ja naisten määrä vuosina 2006-2024. Lähde: Tilastokeskus, kuolemansyyt (Tietokantataulukot: 12d9 – Huumeisiin kuolleet (B-luokitus) tilaston peruskuolemansyyn, iän ja sukupuolen mukaan, 2006-2024)"
  },
  {
    "objectID": "datan-visualisointi.html#taulukko",
    "href": "datan-visualisointi.html#taulukko",
    "title": "YP YD-visualisoinnit",
    "section": "Taulukko",
    "text": "Taulukko\n\nDatan siivous\n\n\nCode\nitsemurhat_yht &lt;- itsemurhat_vakivalta %&gt;% \n  filter(kuolemansyy == \"itsemurha\") %&gt;% \n  filter(as.numeric(vuosi) &gt;= 2006) %&gt;%\n  filter(sukupuoli %in% c(\"Miehet\", \"Naiset\")) %&gt;% \n  group_by(vuosi, sukupuoli, kuolemansyy) %&gt;% \n  summarize(kuolleet_06_24_yht = sum(kuolleet_06_24, na.rm = TRUE)) %&gt;% \n  ungroup()\n\nvakivalta_yht &lt;- itsemurhat_vakivalta %&gt;% \n  filter(kuolemansyy == \"vakivalta\") %&gt;% \n  filter(as.numeric(vuosi) &gt;= 2006) %&gt;%\n  filter(sukupuoli %in% c(\"Miehet\", \"Naiset\")) %&gt;% \n  group_by(vuosi, sukupuoli, kuolemansyy) %&gt;% \n  summarize(kuolleet_06_24_yht = sum(kuolleet_06_24, na.rm = TRUE)) %&gt;% \n  ungroup()\n\nhuumekuolemat_yht &lt;- huumekuolemat %&gt;% \n  filter(sukupuoli %in% c(\"Miehet\", \"Naiset\")) %&gt;% \n  filter(as.numeric(vuosi) &gt;= 2006) %&gt;%\n  group_by(vuosi, sukupuoli, kuolemansyy) %&gt;% \n  summarize(kuolleet_06_24_yht = sum(kuolleet_06_24, na.rm = TRUE)) %&gt;% \n  ungroup()\n\nyd_kuolemat_kaikki &lt;- rbind(itsemurhat_yht, huumekuolemat_yht, vakivalta_yht) %&gt;% \n  tidyr::pivot_wider(names_from = c(kuolemansyy, sukupuoli), \n                     values_from = kuolleet_06_24_yht) %&gt;% \n  rowwise() %&gt;% \n  mutate(yht_m = sum(itsemurha_Miehet, huumekuolema_Miehet, vakivalta_Miehet),\n         yht_n = sum(itsemurha_Naiset, huumekuolema_Naiset, vakivalta_Naiset))\n\n\n\n\nTaulukon printtaus\n\n\nCode\nyd_kuolemat_kaikki %&gt;% \n  rename(itsem_m = \"itsemurha_Miehet\", itsem_n = \"itsemurha_Naiset\",\n         vakiv_m = \"vakivalta_Miehet\", vakiv_n = \"vakivalta_Naiset\",\n         huume_m = \"huumekuolema_Miehet\", huume_n = \"huumekuolema_Naiset\")\n\n\n# A tibble: 19 × 9\n# Rowwise: \n   vuosi itsem_m itsem_n huume_m huume_n vakiv_m vakiv_n yht_m yht_n\n   &lt;chr&gt;   &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;\n 1 2006      158      38      47       7      16       4   221    49\n 2 2007      141      43      47       9      11      11   199    63\n 3 2008      135      40      45      11      17      11   197    62\n 4 2009      149      49      38      16      14       7   201    72\n 5 2010      164      49      38      12      15       5   217    66\n 6 2011      143      39      60      15      14       6   217    60\n 7 2012      135      46      52      14       9       5   196    65\n 8 2013      135      48      44      15       6       4   185    67\n 9 2014      124      35      46       9      10       5   180    49\n10 2015      108      28      35       5       5       3   148    36\n11 2016      110      53      50       8       8       1   168    62\n12 2017      134      45      48      12       6       7   188    64\n13 2018      122      45      72      23       5       4   199    72\n14 2019      129      43      65      26       9       4   203    73\n15 2020       98      49      98      19      14       3   210    71\n16 2021       82      43      77      23      11       3   170    69\n17 2022      106      36      61      21      10       8   177    65\n18 2023      112      58     101      23       9       7   222    88\n19 2024       97      51      64      14      10       4   171    69\n\n\n\n\nTaulukko 2: Sarakkeina vuodet\n\n\nCode\nitsemurhat_yht &lt;- itsemurhat_vakivalta %&gt;% \n  filter(kuolemansyy == \"itsemurha\") %&gt;% \n  filter(as.numeric(vuosi) &gt;= 2006)\n\nvakivalta_yht &lt;- itsemurhat_vakivalta %&gt;% \n  filter(kuolemansyy == \"vakivalta\") %&gt;% \n  filter(as.numeric(vuosi) &gt;= 2006)\n\nhuumekuolemat_yht &lt;- huumekuolemat %&gt;% \n  filter(as.numeric(vuosi) &gt;= 2006)\n\nyd_kuolemat_kaikki_vuosi &lt;- rbind(itsemurhat_yht, huumekuolemat_yht, vakivalta_yht) %&gt;% \n  tidyr::pivot_wider(names_from = vuosi, names_prefix = \"v_\", \n                     values_from = kuolleet_06_24)\n\n\nTaulukon muoto on sellainen, että sen valmiiksi tekeminen on helpointa Excelissä. Tämä code chunk on laitettu eval = FALSE koska emme halua, että tämän dokumentin jokainen renderöinti ylikirjoittaa käsin tehdyt muutokset!\n\n\nCode\nif (FALSE) {\n  write.xlsx(yd_kuolemat_kaikki_vuosi, \"yd_kuolemat_kaikki_vuosi.xlsx\")\n}\n\n\nTässä välissä muokkauksia on tehty Excel-tiedostossa, jonka jälkeen se luetaan taas R:ään. Fontti on asetettu seuraavissa taulukoissa pieneksi jotta ne mahtuisivat paremmin vaakasuunnassa pdf-tiedostoon, mutta selkeyden vuoksi ei kuitenkaan ihan niin pieneksi, että ne mahtuisivat pystysuunnassa olevalle A4-paperille.\n\n\nCode\nuser_font_size &lt;- 7\n\nyd_kuolemat_muokattu_itsemurhat &lt;- xlsx::read.xlsx(\"yd_kuolemat_kaikki_vuosi.xlsx\", 1) %&gt;% \n  filter(sukupuoli %in% c(\"Yhteensä\", \"Miehet (%)\", \"Naiset (%)\")) %&gt;% \n  select(ika, sukupuoli, starts_with(\"v_\"))\nyd_kuolemat_muokattu_huumekuolemat &lt;- xlsx::read.xlsx(\"yd_kuolemat_kaikki_vuosi.xlsx\", 2) %&gt;% \n  filter(sukupuoli %in% c(\"Yhteensä\", \"Miehet (%)\", \"Naiset (%)\")) %&gt;% \n  select(ika, sukupuoli, starts_with(\"v_\")) %&gt;% \n  mutate(across(starts_with(\"v_\"), as.numeric))\nyd_kuolemat_muokattu_vakivalta &lt;- xlsx::read.xlsx(\"yd_kuolemat_kaikki_vuosi.xlsx\", 3) %&gt;% \n  filter(sukupuoli %in% c(\"Yhteensä\", \"Miehet (%)\", \"Naiset (%)\")) %&gt;% \n  select(ika, sukupuoli, starts_with(\"v_\")) %&gt;% \n  mutate(across(starts_with(\"v_\"), as.numeric))\nyd_kuolemat_muokattu_yhteensa &lt;- xlsx::read.xlsx(\"yd_kuolemat_kaikki_vuosi.xlsx\", 4) %&gt;% \n  filter(sukupuoli %in% c(\"Yhteensä\", \"Miehet (%)\", \"Naiset (%)\")) %&gt;% \n  select(ika, sukupuoli, starts_with(\"v_\")) %&gt;% \n  mutate(across(starts_with(\"v_\"), as.numeric))\n\nknitr::kable(yd_kuolemat_muokattu_itsemurhat, format = \"pipe\", caption = \"Itsemurhat\", row.names = FALSE, digits = 1) %&gt;% kableExtra::kable_styling(font_size = user_font_size)\n\n\n\nItsemurhat\n\n\nika\nsukupuoli\nv_2006\nv_2007\nv_2008\nv_2009\nv_2010\nv_2011\nv_2012\nv_2013\nv_2014\nv_2015\nv_2016\nv_2017\nv_2018\nv_2019\nv_2020\nv_2021\nv_2022\nv_2023\n\n\n\n\n15 - 19\nYhteensä\n47.0\n39.0\n37.0\n36.0\n39.0\n43.0\n44.0\n32.0\n28.0\n17.0\n23.0\n32.0\n30.0\n34.0\n32.0\n28.0\n24.0\n45.0\n\n\n15 - 19\nMiehet (%)\n0.8\n0.8\n0.6\n0.8\n0.8\n0.8\n0.7\n0.6\n0.7\n0.9\n0.6\n0.8\n0.7\n0.7\n0.6\n0.6\n0.6\n0.5\n\n\n15 - 19\nNaiset (%)\n0.2\n0.2\n0.4\n0.2\n0.2\n0.2\n0.3\n0.4\n0.3\n0.1\n0.4\n0.2\n0.3\n0.3\n0.4\n0.4\n0.4\n0.5\n\n\n20 - 24\nYhteensä\n80.0\n81.0\n70.0\n81.0\n96.0\n73.0\n73.0\n67.0\n57.0\n54.0\n78.0\n70.0\n63.0\n71.0\n49.0\n48.0\n60.0\n67.0\n\n\n20 - 24\nMiehet (%)\n0.9\n0.7\n0.8\n0.8\n0.8\n0.8\n0.8\n0.7\n0.8\n0.8\n0.6\n0.7\n0.7\n0.7\n0.7\n0.7\n0.8\n0.7\n\n\n20 - 24\nNaiset (%)\n0.1\n0.3\n0.2\n0.2\n0.2\n0.2\n0.2\n0.3\n0.2\n0.2\n0.4\n0.3\n0.3\n0.3\n0.3\n0.3\n0.2\n0.3\n\n\n25 - 29\nYhteensä\n69.0\n64.0\n68.0\n81.0\n78.0\n66.0\n64.0\n84.0\n74.0\n65.0\n62.0\n77.0\n74.0\n67.0\n66.0\n49.0\n58.0\n58.0\n\n\n25 - 29\nMiehet (%)\n0.7\n0.8\n0.8\n0.7\n0.8\n0.8\n0.8\n0.8\n0.8\n0.8\n0.8\n0.8\n0.8\n0.8\n0.7\n0.7\n0.8\n0.7\n\n\n25 - 29\nNaiset (%)\n0.3\n0.2\n0.2\n0.3\n0.2\n0.2\n0.2\n0.2\n0.2\n0.2\n0.2\n0.2\n0.2\n0.2\n0.3\n0.3\n0.2\n0.3\n\n\n\n\n\n\n\nCode\nknitr::kable(yd_kuolemat_muokattu_huumekuolemat, format = \"pipe\", caption = \"Huumekuolemat\", row.names = FALSE, digits = 1) %&gt;% kableExtra::kable_styling(font_size = user_font_size)\n\n\n\nHuumekuolemat\n\n\nika\nsukupuoli\nv_2006\nv_2007\nv_2008\nv_2009\nv_2010\nv_2011\nv_2012\nv_2013\nv_2014\nv_2015\nv_2016\nv_2017\nv_2018\nv_2019\nv_2020\nv_2021\nv_2022\nv_2023\n\n\n\n\n15 - 19\nYhteensä\n10.0\n6.0\n7.0\n5.0\n2.0\n5.0\n8.0\n0.0\n4.0\n3.0\n4.0\n12.0\n20.0\n17.0\n26.0\n22.0\n18.0\n26.0\n\n\n15 - 19\nMiehet (%)\n0.9\n1.0\n1.0\n0.6\n1.0\n1.0\n0.6\nNA\n1.0\n0.7\n1.0\n0.7\n0.7\n0.6\n0.7\n0.8\n0.7\n0.7\n\n\n15 - 19\nNaiset (%)\n0.1\n0.0\n0.0\n0.4\n0.0\n0.0\n0.4\nNA\n0.0\n0.3\n0.0\n0.3\n0.3\n0.4\n0.3\n0.2\n0.3\n0.3\n\n\n20 - 24\nYhteensä\n26.0\n22.0\n25.0\n20.0\n26.0\n27.0\n23.0\n28.0\n18.0\n13.0\n22.0\n25.0\n34.0\n37.0\n46.0\n38.0\n33.0\n65.0\n\n\n20 - 24\nMiehet (%)\n0.8\n0.8\n0.7\n0.5\n0.7\n0.7\n0.8\n0.7\n0.8\n1.0\n0.8\n0.8\n0.8\n0.7\n0.9\n0.8\n0.8\n0.8\n\n\n20 - 24\nNaiset (%)\n0.2\n0.2\n0.3\n0.5\n0.3\n0.3\n0.2\n0.3\n0.2\n0.0\n0.2\n0.2\n0.2\n0.3\n0.1\n0.2\n0.2\n0.2\n\n\n25 - 29\nYhteensä\n18.0\n28.0\n24.0\n29.0\n22.0\n43.0\n35.0\n31.0\n33.0\n24.0\n32.0\n23.0\n41.0\n37.0\n45.0\n40.0\n31.0\n33.0\n\n\n25 - 29\nMiehet (%)\n0.9\n0.8\n0.9\n0.9\n0.8\n0.8\n0.8\n0.8\n0.8\n0.8\n0.9\n0.9\n0.8\n0.8\n0.8\n0.8\n0.8\n0.9\n\n\n25 - 29\nNaiset (%)\n0.1\n0.2\n0.1\n0.1\n0.2\n0.2\n0.2\n0.2\n0.2\n0.2\n0.1\n0.1\n0.2\n0.2\n0.2\n0.2\n0.2\n0.1\n\n\n\n\n\n\n\nCode\nknitr::kable(yd_kuolemat_muokattu_vakivalta, format = \"pipe\", caption = \"Väkivaltakuolemat\", row.names = FALSE, digits = 1) %&gt;% kableExtra::kable_styling(font_size = user_font_size)\n\n\n\nVäkivaltakuolemat\n\n\nika\nsukupuoli\nv_2006\nv_2007\nv_2008\nv_2009\nv_2010\nv_2011\nv_2012\nv_2013\nv_2014\nv_2015\nv_2016\nv_2017\nv_2018\nv_2019\nv_2020\nv_2021\nv_2022\nv_2023\n\n\n\n\n15 - 19\nYhteensä\n3.0\n10.0\n2.0\n4.0\n0.0\n7.0\n5.0\n5.0\n3.0\n3\n1.0\n6.0\n1.0\n1.0\n5.0\n2.0\n4.0\n3.0\n\n\n15 - 19\nMiehet (%)\n1.0\n0.7\n0.5\n0.8\nNA\n0.6\n0.4\n0.6\n1.0\n0\n1.0\n0.3\n0.0\n1.0\n1.0\n1.0\n0.5\n0.3\n\n\n15 - 19\nNaiset (%)\n0.0\n0.3\n0.5\n0.2\nNA\n0.4\n0.6\n0.4\n0.0\n1\n0.0\n0.7\n1.0\n0.0\n0.0\n0.0\n0.5\n0.7\n\n\n20 - 24\nYhteensä\n8.0\n4.0\n16.0\n7.0\n7.0\n4.0\n4.0\n2.0\n2.0\n1\n3.0\n3.0\n4.0\n7.0\n6.0\n4.0\n8.0\n2.0\n\n\n20 - 24\nMiehet (%)\n0.9\n0.2\n0.6\n0.4\n0.9\n0.8\n0.8\n1.0\n0.5\n1\n1.0\n0.7\n0.8\n0.7\n0.8\n0.8\n0.5\n1.0\n\n\n20 - 24\nNaiset (%)\n0.1\n0.8\n0.4\n0.6\n0.1\n0.2\n0.2\n0.0\n0.5\n0\n0.0\n0.3\n0.2\n0.3\n0.2\n0.2\n0.5\n0.0\n\n\n25 - 29\nYhteensä\n9.0\n8.0\n10.0\n10.0\n13.0\n9.0\n5.0\n3.0\n10.0\n4\n5.0\n4.0\n4.0\n5.0\n6.0\n8.0\n6.0\n11.0\n\n\n25 - 29\nMiehet (%)\n0.7\n0.4\n0.7\n0.8\n0.7\n0.8\n0.8\n0.3\n0.6\n1\n0.8\n0.5\n0.5\n0.6\n0.7\n0.8\n0.7\n0.5\n\n\n25 - 29\nNaiset (%)\n0.3\n0.6\n0.3\n0.2\n0.3\n0.2\n0.2\n0.7\n0.4\n0\n0.2\n0.5\n0.5\n0.4\n0.3\n0.2\n0.3\n0.5\n\n\n\n\n\n\n\nCode\nknitr::kable(yd_kuolemat_muokattu_yhteensa, format = \"pipe\", caption = \"Kaikki YD-kuolemat yhteensä\", row.names = FALSE, digits = 1) %&gt;% kableExtra::kable_styling(font_size = user_font_size)\n\n\n\nKaikki YD-kuolemat yhteensä\n\n\nika\nsukupuoli\nv_2006\nv_2007\nv_2008\nv_2009\nv_2010\nv_2011\nv_2012\nv_2013\nv_2014\nv_2015\nv_2016\nv_2017\nv_2018\nv_2019\nv_2020\nv_2021\nv_2022\nv_2023\n\n\n\n\n15 - 19\nYhteensä\n60.0\n55.0\n46.0\n45.0\n41\n55.0\n57.0\n37.0\n35.0\n23.0\n28.0\n50.0\n51.0\n52.0\n63.0\n52.0\n46.0\n74.0\n\n\n15 - 19\nMiehet (%)\n0.8\n0.8\n0.7\n0.7\nNA\n0.8\n0.6\n0.6\n0.8\n0.7\n0.6\n0.7\n0.7\n0.7\n0.7\n0.7\n0.6\n0.6\n\n\n15 - 19\nNaiset (%)\n0.1\n0.2\n0.3\n0.3\nNA\n0.2\n0.4\n0.4\n0.2\n0.3\n0.4\n0.3\n0.3\n0.3\n0.3\n0.3\n0.4\n0.4\n\n\n20 - 24\nYhteensä\n114.0\n107.0\n111.0\n108.0\n129\n104.0\n100.0\n97.0\n77.0\n68.0\n103.0\n98.0\n101.0\n115.0\n101.0\n90.0\n101.0\n134.0\n\n\n20 - 24\nMiehet (%)\n0.9\n0.7\n0.8\n0.7\nNA\n0.8\n0.8\n0.7\n0.8\n0.9\n0.6\n0.7\n0.7\n0.7\n0.8\n0.7\n0.8\n0.7\n\n\n20 - 24\nNaiset (%)\n0.1\n0.3\n0.2\n0.3\nNA\n0.2\n0.2\n0.3\n0.2\n0.1\n0.4\n0.3\n0.3\n0.3\n0.2\n0.3\n0.2\n0.3\n\n\n25 - 29\nYhteensä\n96.0\n100.0\n102.0\n120.0\n113\n118.0\n104.0\n118.0\n117.0\n93.0\n99.0\n104.0\n119.0\n109.0\n117.0\n97.0\n95.0\n102.0\n\n\n25 - 29\nMiehet (%)\n0.8\n0.8\n0.8\n0.8\nNA\n0.8\n0.8\n0.8\n0.8\n0.8\n0.8\n0.8\n0.8\n0.8\n0.8\n0.7\n0.8\n0.8\n\n\n25 - 29\nNaiset (%)\n0.2\n0.2\n0.2\n0.2\nNA\n0.2\n0.2\n0.2\n0.2\n0.2\n0.2\n0.2\n0.2\n0.2\n0.2\n0.3\n0.2\n0.2\n\n\n\n\n\n\n\nTaulukot on myös mahdollista renderöidä käyttämällä gt-pakettia.\n\n\nCode\nyd_kuolemat_muokattu_itsemurhat_table &lt;- yd_kuolemat_muokattu_itsemurhat %&gt;% \n  select(ika, sukupuoli, starts_with(\"v_\")) %&gt;% \n  gt() %&gt;% \n  tab_header(title = \"Itsemurhat\",\n             subtitle = \"Yhteensä (n) ja sukupuolittain (%)\") %&gt;% \n  fmt_number(\n    columns = starts_with(\"v_\"),\n    decimals = 2\n  ) %&gt;% \n  tab_style(style = cell_text(size = \"smaller\"),\n            locations = cells_stub())\n\nyd_kuolemat_muokattu_huumekuolemat_table &lt;- yd_kuolemat_muokattu_huumekuolemat %&gt;% \n  select(ika, sukupuoli, starts_with(\"v_\")) %&gt;% \n  gt() %&gt;% \n  tab_header(title = \"Huumekuolemat\",\n             subtitle = \"Yhteensä (n) ja sukupuolittain (%)\") %&gt;% \n  fmt_number(\n    columns = starts_with(\"v_\"),\n    decimals = 2\n  ) %&gt;% \n  tab_style(style = cell_text(size = \"smaller\"),\n            locations = cells_stub())\n\nyd_kuolemat_muokattu_vakivalta_table &lt;- yd_kuolemat_muokattu_vakivalta %&gt;% \n  select(ika, sukupuoli, starts_with(\"v_\")) %&gt;% \n  gt() %&gt;% \n  tab_header(title = \"Väkivaltakuolemat\",\n             subtitle = \"Yhteensä (n) ja sukupuolittain (%)\") %&gt;% \n  fmt_number(\n    columns = starts_with(\"v_\"),\n    decimals = 2\n  ) %&gt;% \n  tab_style(style = cell_text(size = \"smaller\"),\n            locations = cells_stub())\n\nyd_kuolemat_muokattu_yhteensa_table &lt;- yd_kuolemat_muokattu_yhteensa %&gt;% \n  select(ika, sukupuoli, starts_with(\"v_\")) %&gt;% \ngt() %&gt;% \n  tab_header(title = \"Kaikki YD-kuolemat yhteensä\",\n             subtitle = \"Yhteensä (n) ja sukupuolittain (%)\") %&gt;% \n  fmt_number(\n    columns = starts_with(\"v_\"),\n    decimals = 2\n  ) %&gt;% \n  tab_style(style = cell_text(size = \"smaller\"),\n            locations = cells_stub())\n  \n  \nyd_kuolemat_muokattu_itsemurhat_table\nyd_kuolemat_muokattu_huumekuolemat_table\nyd_kuolemat_muokattu_vakivalta_table\nyd_kuolemat_muokattu_yhteensa_table"
  },
  {
    "objectID": "datan-visualisointi.html#filtteröinti-3",
    "href": "datan-visualisointi.html#filtteröinti-3",
    "title": "YP YD-visualisoinnit",
    "section": "Filtteröinti",
    "text": "Filtteröinti\n\n\nCode\nitsemurhat_yht &lt;- itsemurhat_vakivalta %&gt;% \n  filter(kuolemansyy == \"itsemurha\") %&gt;% \n  filter(as.numeric(vuosi) &gt;= 2006) %&gt;%\n  filter(sukupuoli %in% c(\"Yhteensä\")) %&gt;% \n  group_by(vuosi, sukupuoli, kuolemansyy) %&gt;% \n  summarize(kuolleet_06_24_yht = sum(kuolleet_06_24, na.rm = TRUE)) %&gt;% \n  ungroup()\n\nvakivalta_yht &lt;- itsemurhat_vakivalta %&gt;% \n  filter(kuolemansyy == \"vakivalta\") %&gt;% \n  filter(as.numeric(vuosi) &gt;= 2006) %&gt;%\n  filter(sukupuoli %in% c(\"Yhteensä\")) %&gt;% \n  group_by(vuosi, sukupuoli, kuolemansyy) %&gt;% \n  summarize(kuolleet_06_24_yht = sum(kuolleet_06_24, na.rm = TRUE)) %&gt;% \n  ungroup()\n\nkaikki_muut_yht &lt;- itsemurhat_vakivalta %&gt;% \n  filter(kuolemansyy == \"muut\") %&gt;% \n  filter(as.numeric(vuosi) &gt;= 2006) %&gt;%\n  filter(sukupuoli %in% \"Yhteensä\") %&gt;% \n  group_by(vuosi, sukupuoli, kuolemansyy) %&gt;% \n  summarize(kuolleet_06_24_yht = sum(kuolleet_06_24, na.rm = TRUE)) %&gt;% \n  ungroup()\n\nhuumekuolemat_yht &lt;- huumekuolemat %&gt;% \n  filter(sukupuoli %in% c(\"Yhteensä\")) %&gt;% \n  filter(as.numeric(vuosi) &gt;= 2006) %&gt;%\n  group_by(vuosi, sukupuoli, kuolemansyy) %&gt;% \n  summarize(kuolleet_06_24_yht = sum(kuolleet_06_24, na.rm = TRUE)) %&gt;% \n  ungroup()\n\nkaikki &lt;- rbind(itsemurhat_yht, vakivalta_yht, huumekuolemat_yht, kaikki_muut_yht)\n\nkaikki_wide &lt;- kaikki %&gt;% \n  pivot_wider(names_from = kuolemansyy, values_from = kuolleet_06_24_yht) %&gt;% \n  mutate(muut = muut - itsemurha - vakivalta - huumekuolema)\n\nkaikki_long &lt;- kaikki_wide %&gt;% \n  pivot_longer(!c(vuosi, sukupuoli), names_to = \"kuolemansyy\") %&gt;% \n  mutate(kuolemansyy = factor(kuolemansyy, levels=c(\"huumekuolema\", \"vakivalta\", \"itsemurha\", \"muut\")))\n\nkaikki_long &lt;- kaikki_long %&gt;% \n  mutate(kuolemansyy = factor(kuolemansyy, levels=c(\"muut\", \"itsemurha\", \"huumekuolema\", \"vakivalta\"), labels = c(\"Kaikki kuolemansyyt \\n(pl. YD-syyt)\", \"Itsemurha\", \"Huumekuolema\", \"Väkivalta\")))"
  },
  {
    "objectID": "datan-visualisointi.html#visualisointi-geom_bar-stack",
    "href": "datan-visualisointi.html#visualisointi-geom_bar-stack",
    "title": "YP YD-visualisoinnit",
    "section": "Visualisointi (geom_bar stack)",
    "text": "Visualisointi (geom_bar stack)\n\nKuvio 3a: Mustavalkoinen kuvio, joissa on mukana title, caption ja y-akselin label\n\n\nCode\nggplot(kaikki_long, aes(fill = kuolemansyy, y=value, x=as.numeric(vuosi))) +\n  geom_bar(position=\"stack\", stat=\"identity\", color = \"black\") + \n  labs(title = \"Eri syistä kuolleet 15-29 -vuotiaat 2006-2024\",\n       caption = \"Lähde: Tilastokeskus / StatFin (statfin_ksyyt_pxt_11az, statfin_ksyyt_pxt_12d9)\",\n       x = \"Vuosi\",\n       y = \"Kuolleita (n)\",\n       fill = \"Kuolemansyy\") +\n  scale_fill_grey() +\n  theme(legend.position = \"right\")\n\n\n\n\n\n\n\nKuvio 3b: Värillinen kuvio ilman labeleita\nKuolemansyiden visualisointiin käytetään tässä väripalettia Dark2 joka on colorblind safe, qualitative (ks. lisätietoja ja lisää paletteja: colorbrewer2.org).\n\n\nCode\nggplot(kaikki_long, aes(fill = kuolemansyy, y=value, x=as.numeric(vuosi))) +\n  geom_bar(position=\"stack\", stat=\"identity\", color = \"black\") + \n  labs(x = \"Vuosi\",\n       y = \"\",\n       fill = \"Kuolemansyy\") +\n  scale_fill_brewer(palette = \"Dark2\") +\n  theme_minimal() +\n  theme(legend.position = \"right\")\n\n\n\n\n\nKuvateksti: Eri syistä kuolleiden 15-29 -vuotiaiden lukumäärät vuosina 2006-2024. Lähteet: Tilastokeskus, kuolemansyyt (Tietokantataulukot: 11az – Kuolleet tilaston peruskuolemansyyn (aikasarjaluokitus), iän ja sukupuolen mukaan, 1969-2024, 12d9 – Huumeisiin kuolleet (B-luokitus) tilaston peruskuolemansyyn, iän ja sukupuolen mukaan, 2006-2024)"
  },
  {
    "objectID": "datan-visualisointi.html#absoluuttiset-lukuarvot",
    "href": "datan-visualisointi.html#absoluuttiset-lukuarvot",
    "title": "YP YD-visualisoinnit",
    "section": "Absoluuttiset lukuarvot",
    "text": "Absoluuttiset lukuarvot\n\nFiltteröinti\nVerrattuna aiempiin vaiheisiin, tässä on pudotettu pois vuoden perusteella filtteröinti. Toisin sanottuna mukaan otetaan kaikki havainnot aineiston alkupisteestä asti. Huumekuolemat-aineisto alkaa vasta vuodesta 2006.\n\n\nCode\nitsemurhat_yht_70 &lt;- itsemurhat_vakivalta %&gt;% \n  filter(kuolemansyy == \"itsemurha\") %&gt;% \n  filter(sukupuoli %in% c(\"Yhteensä\")) %&gt;% \n  group_by(vuosi, sukupuoli, kuolemansyy) %&gt;% \n  summarize(kuolleet_yht = sum(kuolleet_06_24, na.rm = TRUE)) %&gt;% \n  ungroup()\n\nvakivalta_yht_70 &lt;- itsemurhat_vakivalta %&gt;% \n  filter(kuolemansyy == \"vakivalta\") %&gt;% \n  filter(sukupuoli %in% c(\"Yhteensä\")) %&gt;% \n  group_by(vuosi, sukupuoli, kuolemansyy) %&gt;% \n  summarize(kuolleet_yht = sum(kuolleet_06_24, na.rm = TRUE)) %&gt;% \n  ungroup()\n\nkaikki_muut_yht_70 &lt;- itsemurhat_vakivalta %&gt;% \n  filter(kuolemansyy == \"muut\") %&gt;% \n  filter(sukupuoli %in% \"Yhteensä\") %&gt;% \n  mutate(kuolemansyy = \"kaikki_kuolemansyyt\") %&gt;% \n  group_by(vuosi, sukupuoli, kuolemansyy) %&gt;% \n  summarize(kuolleet_yht = sum(kuolleet_06_24, na.rm = TRUE)) %&gt;% \n  ungroup()\n\nhuumekuolemat_yht_70 &lt;- huumekuolemat %&gt;% \n  filter(sukupuoli %in% c(\"Yhteensä\")) %&gt;% \n  group_by(vuosi, sukupuoli, kuolemansyy) %&gt;% \n  summarize(kuolleet_yht = sum(kuolleet_06_24, na.rm = TRUE)) %&gt;% \n  ungroup()\n\nkaikki_70 &lt;- rbind(itsemurhat_yht_70, vakivalta_yht_70, huumekuolemat_yht_70, kaikki_muut_yht_70) %&gt;% \n  mutate(kuolemansyy = factor(kuolemansyy, levels=c(\"kaikki_kuolemansyyt\", \"itsemurha\", \"huumekuolema\", \"vakivalta\"), labels = c(\"Kaikki kuolemansyyt \\n(ml. YD-syyt)\", \"Itsemurha\", \"Huumekuolema\", \"Väkivalta\")))\n\n# kaikki_wide_70 &lt;- kaikki_70 %&gt;%\n#   pivot_wider(names_from = kuolemansyy, values_from = kuolleet_yht) %&gt;%\n#   mutate(muut = muut - itsemurha - vakivalta - huumekuolema)\n# \n# kaikki_long_70 &lt;- kaikki_wide_70 %&gt;%\n#   pivot_longer(!c(vuosi, sukupuoli), names_to = \"kuolemansyy\")\n\n\n\n\nVisualisointi (geom_line)\nMustavalkoinen kuvio:\n\n\nCode\nggplot(data = kaikki_70, aes(x = as.numeric(vuosi), y = kuolleet_yht, group = kuolemansyy)) +\n  geom_line(aes(color=kuolemansyy)) + \n  labs(title = \"Eri syistä kuolleet 15-29 -vuotiaat 1969-2024\",\n       caption = \"Lähde: Tilastokeskus / StatFin (statfin_ksyyt_pxt_11az, statfin_ksyyt_pxt_12d9)\",\n       x = \"Vuosi\",\n       y = \"Kuolleita (n)\",\n       colour = \"Kuolemansyy\") +\n  scale_color_grey() +\n  theme(legend.position = \"right\")\n\n\n\n\n\nKuolemansyiden visualisointiin käytetään tässä väripalettia Dark2 joka on colorblind safe, qualitative (ks. lisätietoja ja lisää paletteja: colorbrewer2.org).\n\n\nCode\nggplot(data = kaikki_70, aes(x = as.numeric(vuosi), y = kuolleet_yht, group = kuolemansyy)) +\n  geom_line(aes(color=kuolemansyy)) + \n  labs(x = \"Vuosi\",\n       y = \"Kuolleita (n)\",\n       colour = \"Kuolemansyy\") +\n  scale_colour_brewer(palette = \"Dark2\") +\n  theme(legend.position = \"right\")\n\n\n\n\n\nKuvateksti: 15-29 -vuotiaana kuolleiden lukumäärä 1969-2024. Lähteet: Tilastokeskus, kuolemansyyt (Tietokantataulukot: 11az – Kuolleet tilaston peruskuolemansyyn (aikasarjaluokitus), iän ja sukupuolen mukaan, 1969-2024, 12d9 – Huumeisiin kuolleet (B-luokitus) tilaston peruskuolemansyyn, iän ja sukupuolen mukaan, 2006-2024)"
  },
  {
    "objectID": "datan-visualisointi.html#suhteutettuna-ikäluokan-kokoon",
    "href": "datan-visualisointi.html#suhteutettuna-ikäluokan-kokoon",
    "title": "YP YD-visualisoinnit",
    "section": "Suhteutettuna ikäluokan kokoon",
    "text": "Suhteutettuna ikäluokan kokoon\n\nMääritelmä: ASDR\n\nIkäryhmittäinen kuolleisuusluku (Age Specific Death Rate, ASDR) vastaa ikäryhmittäistä hedelmällisyyslukua niin hyvien kuin huonenkin ominaisuuksiensa osalta. Se on täsmällinen mittaluku, mutta se pilkkoo tiedon kuolleisuudesta niin moneen pieneen palaseen, että kokonaiskuvaa on vaikea saada. Esimerkiksi 25-29-vuotiaille ikäryhmittäinen kuolleisuusluku lasketaan seuraavanlaisessa kaavalla:\n\\[\nASDR = \\frac{\\text{25-29 vuotiaana kuolleet vuonna A}}{\\text{25-29-vuotiaiden keskiväkiluku vuonna A}} \\times 1000\n\\]\n(Suomen väestö -teos)\n\nKategorisoidaan ensin 1 ikävuoden välein otetut keskiväkiluvut aiemmin käytettyihin kategorioihin 15 - 19, 20 - 24 ja 25-29.\n\n\nCode\nstatfin_vaerak_pxt_11s1 &lt;- readRDS(\"prepared_data/statfin_vaerak_pxt_11s1.rds\")\n\nkeskivakiluvut &lt;- statfin_vaerak_pxt_11s1 %&gt;% \n  mutate(ikaryhma = case_when(\n    ika %in% as.character(15:19) ~ \"15 - 19\",\n    ika %in% as.character(20:24) ~ \"20 - 24\",\n    ika %in% as.character(25:29) ~ \"25 - 29\",\n    .default = \"muut\"\n  )) %&gt;% \n  group_by(vuosi, sukupuoli, ikaryhma) %&gt;% \n  summarize(keskivakiluku_ikaryhma = sum(keskivakiluku)) %&gt;% \n  ungroup()\n\nkeskivakiluvut_15_29 &lt;- statfin_vaerak_pxt_11s1 %&gt;% \n  mutate(ikaryhma = \"15 - 29\") %&gt;% \n  group_by(vuosi, sukupuoli, ikaryhma) %&gt;% \n  summarize(keskivakiluku_ikaryhma = sum(keskivakiluku)) %&gt;% \n  ungroup()\n\n\nLasketaan sitten kuolleiden määrän ja keskiväkiluvun suhteesta saatava ASDR.\n\n\nCode\nkeskivakiluvut_15_29 &lt;- keskivakiluvut_15_29 %&gt;% \n  filter(sukupuoli == \"Yhteensä\") %&gt;% \n  select(vuosi, keskivakiluku_ikaryhma)\n\nkaikki_70_asdr &lt;- left_join(kaikki_70, keskivakiluvut_15_29, by = join_by(\"vuosi\" == \"vuosi\")) %&gt;% \n  filter(as.numeric(vuosi) &gt; 1981) %&gt;% \n  mutate(asdr = (kuolleet_yht / keskivakiluku_ikaryhma) * 1000)\n\n\nOngelmallista ylemmässä on se, että keskiväkiluvut ulottuvat vain vuoteen 1981 asti. Käytetään siis itse laskettua keskiväkilukua.\n\n\nCode\nitse_laskettu_keskivakiluku &lt;- itse_laskettu_keskivakiluku %&gt;% \n  filter(as.character(vuosi) &gt; 1960)\n\nkaikki_70_asdr &lt;- left_join(kaikki_70, itse_laskettu_keskivakiluku, by = join_by(\"vuosi\" == \"vuosi\")) %&gt;% \n  mutate(asdr = (kuolleet_yht / keskivakiluku) * 1000)\n\n\n\n\nVisualisointi (geom_line)\n\nMustavalkoinen\n\n\nCode\nggplot(data = kaikki_70_asdr, aes(x = as.numeric(vuosi), y = asdr, group = kuolemansyy)) +\n  geom_line(aes(color=kuolemansyy)) + \n  labs(title = \"Eri syistä kuolleet 15-29 -vuotiaat 1969-2024 (ikävakioitu)\",\n       caption = \"Lähde: Tilastokeskus / StatFin \\n(Tietokantataulukot: statfin_ksyyt_pxt_11az,\\n statfin_ksyyt_pxt_12d9, statfin_vaerak_pxt_11rc)\",\n       x = \"Vuosi\",\n       y = \"Per 1000 samanikäistä\",\n       colour = \"Kuolemansyy\") +\n  scale_color_grey() +\n  theme(legend.position = \"right\")\n\n\n\n\n\n\n\nVärillinen\nKuolemansyiden visualisointiin käytetään tässä väripalettia Dark2 joka on colorblind safe, qualitative (ks. lisätietoja ja lisää paletteja: colorbrewer2.org).\n\n\nCode\nggplot(data = kaikki_70_asdr, aes(x = as.numeric(vuosi), y = asdr, group = kuolemansyy)) +\n  geom_line(aes(color=kuolemansyy)) + \n  labs(x = \"Vuosi\",\n       y = \"\",\n       colour = \"Kuolemansyy\") +\n  scale_colour_brewer(palette = \"Dark2\") +\n  theme(legend.position = \"right\")\n\n\n\n\n\nKuvateksti: 15-29 -vuotiaiden kuolleisuus 1969-2024 (ikävakioitu). Kuolinluvut per 1000 samanikäistä. Lähteet: Tilastokeskus, kuolemansyyt (Tietokantataulukot: 11az – Kuolleet tilaston peruskuolemansyyn (aikasarjaluokitus), iän ja sukupuolen mukaan, 1969-2024, 12d9 – Huumeisiin kuolleet (B-luokitus) tilaston peruskuolemansyyn, iän ja sukupuolen mukaan, 2006-2024), Tilastokeskus, väestörakenne (Tietokantataulukko: 11rc – Väestö iän (5-v.) ja sukupuolen mukaan, 1865-2024)\n\n\n\nKuvio 5: Datan tallennus exceliin\n\n\nCode\nlibrary(\"xlsx\")\n\nkaikki_70_asdr_wide &lt;- kaikki_70_asdr %&gt;% \n  dplyr::select(vuosi, kuolemansyy, asdr) %&gt;% \n  tidyr::pivot_wider(names_from = kuolemansyy, values_from = asdr)\n\nif (kirjoita_data_excel_tiedostoihin) {\n  write.xlsx(kaikki_70_asdr_wide,\n           file = \"prepared_data/yd_artikkeli_kuviot.xlsx\",\n           sheetName = \"Kuvio_5_asdr\", \n           append = TRUE)\n}"
  }
]